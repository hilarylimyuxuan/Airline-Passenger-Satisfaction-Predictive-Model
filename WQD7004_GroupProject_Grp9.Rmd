---
title: "WQD7004 Group Project - Group 9"
output:
  html_document:
    toc: yes
    toc_float:
      collapsed: yes
      smooth_scroll: yes
    toc_depth: 3
    number_sections: yes
    theme: spacelab
  word_document:
    toc: yes
    toc_depth: '3'
  pdf_document:
    toc: yes
    toc_depth: '3'
editor_options:
  chunk_output_type: console
---

# Introduction

This is introduction

# Objectives

# Methodology

## Data Understanding

```{r include = FALSE, warning = FALSE}
# install.packages('stringr')
# install.packages('data.table')
# install.packages('ggpubr')
# install.packages('tidyr')
# install.packages('ggrepel')
# install.packages('GGally')
# install.packages('vip')
# install.packages('patchwork')
# install.packages('ggplot2')
# install.packages('dplyr')
# install.packages('magrittr')
# load library
library(stringr)
library(dplyr)
library(data.table)
library(ggplot2)
library(ggpubr)
library(tidyr)
library(ggrepel)
library(GGally)
library(vip)
library(patchwork)
library(magrittr)

# read csv
airline_df <- read.csv("Airline Passenger Satisfaction Dataset\\train_unclean.csv"
                       , header = TRUE
                       , stringsAsFactors = TRUE)

# display dataframe
head(airline_df)

# data dimension
dim(airline_df)

# data class
sapply(airline_df, class)

# summary statistics
summary(airline_df)
```

## Data Cleaning

```{r include = FALSE, warning = FALSE}
# check duplicate
dim(airline_df[duplicated(airline_df$id),])[1]
# no duplicate

# check NA count in each column
colSums(is.na(airline_df))
# Departure.Delay.in.Minutes: 92
# Arrival.Delay.in.Minutes: 310

# check distinct values for each categorical column
levels(airline_df$Gender)
levels(airline_df$Customer.Type)
levels(airline_df$Type.of.Travel)
levels(airline_df$Class)
```

```{r include = FALSE, warning = FALSE}
# data cleaning
# convert gender and customer type into proper case
airline_df$Gender.C = as.factor(str_to_title(airline_df$Gender))
levels(airline_df$Gender)
airline_df$Customer.Type.C = as.factor(str_to_title(airline_df$Customer.Type))
levels(airline_df$Customer.Type)

# clean type of travel
airline_df$Type.of.Travel.C <- 
  ifelse(grepl('^b', airline_df$Type.of.Travel, ignore.case = TRUE), 
         "Business Travel",
         "Personal Travel")
airline_df$Type.of.Travel.C <- as.factor(airline_df$Type.of.Travel.C)
levels(airline_df$Type.of.Travel.C)

# clean class
airline_df$Class.C <- 
  ifelse(grepl('^b', airline_df$Class, ignore.case = TRUE), 
         "Business",
         ifelse(grepl('^(ekon|econ|Eco$)', airline_df$Class, ignore.case = TRUE),
                "Eco",
                "Eco Plus")
         )
airline_df$Class.C <- as.factor(airline_df$Class.C)
levels(airline_df$Class.C)

# clean inflight wifi service rating
# set ratings above 5 as NA and replace with mean exclude 0
airline_df$Inflight.wifi.service.C <- airline_df$Inflight.wifi.service
airline_df$Inflight.wifi.service.C[airline_df$Inflight.wifi.service.C > 5] <- NA
airline_df$Inflight.wifi.service.C[is.na(airline_df$Inflight.wifi.service.C)] <-
  mean(airline_df$Inflight.wifi.service.C
       [airline_df$Inflight.wifi.service.C > 0]
       , na.rm = TRUE
       )
# convert to integer
airline_df$Inflight.wifi.service.C <- 
  round(airline_df$Inflight.wifi.service.C)

# clean food and drink rating
# set ratings above 5 as NA and replace with mean exclude 0
airline_df$Food.and.drink.C <- airline_df$Food.and.drink
airline_df$Food.and.drink.C[airline_df$Food.and.drink.C > 5] <- NA
airline_df$Food.and.drink.C[is.na(airline_df$Food.and.drink.C)] <-
  mean(airline_df$Food.and.drink.C
       [airline_df$Food.and.drink.C > 0]
       , na.rm = TRUE
       )
# convert to integer
airline_df$Food.and.drink.C <- 
  round(airline_df$Food.and.drink.C)

# clean seat comfort
# set ratings above 5 as NA and replace with mean exclude 0
airline_df$Seat.comfort.C <- airline_df$Seat.comfort
airline_df$Seat.comfort.C[airline_df$Seat.comfort.C > 5] <- NA
airline_df$Seat.comfort.C[is.na(airline_df$Seat.comfort.C)] <-
  mean(airline_df$Seat.comfort.C
       [airline_df$Seat.comfort.C > 0]
       , na.rm = TRUE
       )
# convert to integer
airline_df$Seat.comfort.C <- 
  round(airline_df$Seat.comfort.C)

# convert all ratings column to ordinal factor
ratings <- c("Inflight.wifi.service.C", "Food.and.drink.C", "Seat.comfort.C",
          "Departure.Arrival.time.convenient",	"Ease.of.Online.booking",
          "Gate.location", "Online.boarding", "Inflight.entertainment",
          "On.board.service",	"Leg.room.service",	"Baggage.handling",
          "Checkin.service",	"Inflight.service",	"Cleanliness"
          )
airline_df[ratings] <- lapply(airline_df[ratings], 
                              factor, 
                              levels=c(0, 1, 2, 3, 4, 5)
                              )

# replace NA with 0
# Departure & Arrival delay in minutes
delay_cols <- c("Departure.Delay.in.Minutes", "Arrival.Delay.in.Minutes")
airline_df[delay_cols][is.na(airline_df[delay_cols])] <- 0

# rearrange columns
col_order <- c("X", "id", "Gender", "Gender.C", "Customer.Type",
               "Customer.Type.C", "Age", "Type.of.Travel", "Type.of.Travel.C",
               "Class", "Class.C","Flight.Distance", "Inflight.wifi.service", 
               "Inflight.wifi.service.C", "Departure.Arrival.time.convenient",	
               "Ease.of.Online.booking", "Gate.location", "Food.and.drink",
               "Food.and.drink.C", "Online.boarding", "Seat.comfort", 
               "Seat.comfort.C", "Inflight.entertainment", "On.board.service",	
               "Leg.room.service", "Baggage.handling", "Checkin.service",	
               "Inflight.service",	"Cleanliness", "Departure.Delay.in.Minutes",
               "Arrival.Delay.in.Minutes", "satisfaction"
               )
airline_df <- airline_df[, col_order]

# drop columns
drop_col <- c("Gender", "Customer.Type", "Type.of.Travel", "Class",
              "Inflight.wifi.service", "Food.and.drink", "Seat.comfort")
airline_df[, drop_col] <- list(NULL)

# rename columns
old_colnames <- c("Gender.C", "Customer.Type.C", "Type.of.Travel.C", "Class.C", 
                  "Inflight.wifi.service.C", "Food.and.drink.C", "Seat.comfort.C"
                  )
new_colnames <- drop_col
setnames(airline_df, old = old_colnames, new = new_colnames)

# drop X column
airline_df[, "X"] <- list(NULL)
```

## Analyses

```{r include = FALSE, warning = FALSE}
write.csv(airline_df,'Airline Passenger Satisfaction Dataset\\train_clean.csv')
```

### Overall

```{r echo = FALSE, warning = FALSE}

# Inflight.wifi.service
inflight_wifi_service_g <- ggplot(airline_df, aes(Inflight.wifi.service, colour = Inflight.wifi.service, fill = Inflight.wifi.service)) + geom_bar(position = "dodge") + 
  labs(title = "Inflight.wifi.service Overall Ratings", colour = "Inflight.wifi.service")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

# Departure.Arrival.time.convenient
departure_g <- ggplot(airline_df, aes(Departure.Arrival.time.convenient, colour = Departure.Arrival.time.convenient, fill = Departure.Arrival.time.convenient)) + geom_bar(position = "dodge") + 
  labs(title = "Departure Arrival time convenient Overall Ratings", colour = "Departure.Arrival.time.convenient")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

# Ease.of.Online.booking 
online_booking_g <- ggplot(airline_df, aes(Ease.of.Online.booking, colour = Ease.of.Online.booking, fill = Ease.of.Online.booking)) + geom_bar(position = "dodge") + 
  labs(title = "Ease.of.Online.booking Overall Ratings", colour = "Ease.of.Online.booking")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

# Gate.location
gate_location_g <- ggplot(airline_df, aes(Gate.location, colour = Gate.location, fill = Gate.location)) + geom_bar(position = "dodge") + 
  labs(title = "Gate.location Overall Ratings", colour = "Gate.location")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

# Online.boarding 
online_boarding_g <- ggplot(airline_df, aes(Online.boarding, colour = Online.boarding, fill = Online.boarding)) + geom_bar(position = "dodge") + 
  labs(title = "Online.boarding Overall Ratings", colour = "Online.boarding")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

# Seat.comfort 
seat_comfort_g <- ggplot(airline_df, aes(Seat.comfort, colour = Seat.comfort, fill = Seat.comfort)) + geom_bar(position = "dodge") + 
  labs(title = "Seat.comfort Overall Ratings", colour = "Seat.comfort")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

# Inflight.entertainment across Type of Travel
inflight_entertainment_g <- ggplot(airline_df, aes(Inflight.entertainment, colour = Inflight.entertainment, fill = Inflight.entertainment)) + geom_bar(position = "dodge") + 
  labs(title = "Inflight.entertainment Overall Ratings", colour = "Inflight.entertainment")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

# On.board.service across Type of Travel
onboard_service_g <- ggplot(airline_df, aes(On.board.service, colour = On.board.service, fill = On.board.service)) + geom_bar(position = "dodge") + 
  labs(title = "On.board.service Overall Ratings", colour = "On.board.service")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

# Leg.room.service across Type of Travel
legroom_service_g <- ggplot(airline_df, aes(Leg.room.service, colour = Leg.room.service, fill = Leg.room.service)) + geom_bar(position = "dodge") + 
  labs(title = "Leg.room.service Overall Ratings", colour = "Leg.room.service")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

# Baggage.handling across Type of Travel
baggage_handling_g <- ggplot(airline_df, aes(Baggage.handling, colour = Baggage.handling, fill = Baggage.handling)) + geom_bar(position = "dodge") + 
  labs(title = "Baggage.handling Overall Ratings", colour = "Baggage.handling")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

# Checkin.service 
checkin_service_g <- ggplot(airline_df, aes(Checkin.service, colour = Checkin.service, fill = Checkin.service)) + geom_bar(position = "dodge") + 
  labs(title = "Checkin.service Overall Ratings", colour = "Checkin.service")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

# Inflight.service
inflight_service_g <- ggplot(airline_df, aes(Inflight.service, colour = Inflight.service, fill = Inflight.service)) + geom_bar(position = "dodge") + 
  labs(title = "Inflight.service Overall Ratings", colour = "Inflight.service")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

# Cleanliness 
cleanliness_g <- ggplot(airline_df, aes(Cleanliness, colour = Cleanliness, fill = Cleanliness)) + geom_bar(position = "dodge") + 
  labs(title = "Cleanliness Overall Ratings", colour = "Cleanliness")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))
```

### Customer Gender

```{r include = FALSE, warning = FALSE}
#1a gender -table
cs_gender_df <- airline_df %>%
  group_by(Gender) %>%
  summarise(counts = n())%>% 
  mutate(perc = counts / sum(counts)) %>% 
  arrange(perc) %>%
  mutate(labels = scales::percent(perc))

#2a customer gender by customer type- table
cs_gender_cust_type_df <- airline_df %>%
  group_by(Gender, Customer.Type) %>%
  summarise(counts = n())

#3a customer gender by customer type and type of travel- table
cs_gender_cust_type_travel_df <- airline_df %>%
  group_by(Gender, Customer.Type, Type.of.Travel) %>%
  summarise(counts = n())

#4a customer gender by type of travel and class- table
cs_gender_travel_class_df <- airline_df %>%
  group_by(Gender, Type.of.Travel, Class) %>%
  summarise(counts = n())

#5a Create age group
airline_df["age_group"] = cut(airline_df$Age, c(0, 10, 20, 30, 40, 50, 60, 70, 80, Inf), c("0-10", "11-20", "21-30","31-40","41-50","51-60","61-70","71-80", ">80"), include.lowest=TRUE)

#5b customer gender by age group and customer type- table
cs_gender_age_type_df <- airline_df %>%
  group_by(Gender, age_group,Customer.Type) %>%
  summarise(counts = n())

#6b customer gender by satisfaction- table
cs_gender_satisfied_df <- airline_df %>%
  group_by(Gender, satisfaction) %>%
  summarise(counts = n())

#6d customer gender by age group and satisfaction- table
cs_gender_age_satisfied_df <- airline_df %>%
  group_by(Gender, age_group, satisfaction) %>%
  summarise(counts = n())
```

```{r echo = FALSE, warning = FALSE}
#1b gender -pie (Demographics)
cs_gender_g <- 
  ggplot(cs_gender_df, 
         aes(x = "",
             y = perc, 
             fill = Gender)) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start = 0) +
  guides(fill=guide_legend(title="Customer Gender")) +
  geom_text(aes(label = labels), 
            position = position_stack(vjust = 0.5),
            show.legend = FALSE) +
  scale_fill_brewer(palette="PRGn") +
  labs(title = "Customer Gender") +
  theme_void()
cs_gender_g

#2b customer gender by customer type- graph
# Disloyal customer comprises of 20% of the whole dataset, of which 19% of female customers are disloyal, i.e. 2 % higher than male customers.
cs_gender_cust_type_g <- 
  ggplot(cs_gender_cust_type_df, 
         aes(x = Customer.Type,
             y = counts)) + 
  geom_bar(stat='identity', position = "dodge") +
  labs(x = "Customer Type", y = "Frequency") + 
  facet_wrap(~Gender) +
  scale_fill_brewer(palette="Spectral")+ 
  ggtitle("Customer Type by Gender in Train Dataset")
cs_gender_cust_type_g

#3b customer gender by customer type and type of travel- graph
#From the customer type, it is observed that almost all the disloyal customers came from business travel(99%), regardless of the gender.
cs_gender_cust_type_travel_g <- 
  ggplot(cs_gender_cust_type_travel_df, 
         aes(x = Customer.Type,
             y = counts, 
             fill = Type.of.Travel)) + 
  geom_bar(stat='identity', position = "dodge") +
  labs(x = "Customer.Type", y = "Frequency") + 
  facet_wrap(~Gender) +
  scale_fill_brewer(palette="Spectral")+ 
  ggtitle("Customer Type by Gender and Travel Type in Train Dataset")
cs_gender_cust_type_travel_g

#4b customer type by type of travel and class- graph
cs_gender_travel_class_g <- 
  ggplot(cs_gender_travel_class_df, 
         aes(x = Type.of.Travel,
             y = counts, 
             fill = Class)) + 
  geom_bar(stat='identity', position = "dodge") +
  labs(x = "Type of Travel", y = "Frequency") + 
  facet_wrap(~Gender) +
  scale_fill_brewer(palette="Spectral")+ 
  ggtitle("Customer Type by Travel Type and Class in Train Dataset")
cs_gender_travel_class_g

#5c customer gender by age group and customer type- graph
cs_gender_age_type_g <- 
  ggplot(cs_gender_age_type_df, 
         aes(x = age_group,
             y = counts,
             fill = Customer.Type)) + 
  geom_bar(stat='identity', position = "dodge") +
  labs(x = "age_group", y = "Frequency") + 
  facet_wrap(~Gender) +
  scale_fill_brewer(palette="Spectral")+ 
  ggtitle("Customer Type by Gender and Age Group in Train Dataset")
cs_gender_age_type_g

#6a Satisfaction count graph
#57% of the whole datasets comprises of neutral or dissatisfied customers, regardless of gender.
satisfaction_count <- airline_df %>% 
  count(satisfaction) %>% 
  ggplot(aes(x = satisfaction, y = n, fill = satisfaction)) +
  geom_bar(stat = "identity", colour = "black", alpha = 0.75) +
  geom_text(aes(label = n), 
                position=position_dodge(width=0.9), 
                vjust=-0.5) + 
  ylim(0, 60000) + 
  labs(y = "Count") + 
  scale_fill_brewer(palette="Spectral") + 
  ggtitle("Satisfaction variable in Train Dataset")
satisfaction_count
  
#6c customer gender by satisfaction- graph
cs_gender_satisfied_g <- 
  ggplot(cs_gender_satisfied_df, 
         aes(x = satisfaction,
             y = counts)) + 
  geom_bar(stat='identity', position = "dodge") +
  labs(x = "satisfaction", y = "Frequency") + 
  facet_wrap(~Gender) +
  scale_fill_brewer(palette="Spectral") + 
  ggtitle("Satisfaction by Gender in Train Dataset")
cs_gender_satisfied_g
  
#6e customer gender by age group and satisfaction- graph 
#Most of the disloyal customers aged between 21-30, followed by 31-40 age group. Possible reason is that people of younger adults are more inclined in trying different airlines that offers good deals. 
cs_gender_age_satisfied_g <- 
  ggplot(cs_gender_age_satisfied_df, 
         aes(x = satisfaction,
             y = counts,
             fill = age_group)) + 
  geom_bar(stat='identity', position = "dodge") +
  labs(x = "satisfaction", y = "Frequency") + 
  facet_wrap(~Gender) +
  scale_fill_brewer(palette="Spectral") + 
  ggtitle("Satisfaction by Gender and Age Group in Train Dataset")
cs_gender_age_satisfied_g

#7 age histogram (Demographics)
age_hist<- ggplot(data = airline_df, aes( x = Age)) + 
  geom_density(fill="navy blue", color="black", alpha=0.75) +
  labs(title = "Distribution of Age", 
       subtitle = "Airline Passenger Satisfaction")
age_hist


# Inflight.wifi.service across Gender
service1_g <- ggplot(airline_df, aes(Inflight.wifi.service, colour = Gender, fill = Gender)) + geom_bar(position = "dodge") + scale_fill_manual(values=c("#9933FF","#33FFFF"))+
  labs(title = "Inflight.wifi.service vs Gender", colour = "Gender")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5)) 
service1_g
# Departure.Arrival.time.convenient across Gender
service2_g <- ggplot(airline_df, aes(Departure.Arrival.time.convenient, colour = Gender, fill = Gender)) + geom_bar(position = "dodge")+ scale_fill_manual(values=c("#9933FF","#33FFFF"))+ 
  labs(title = "Departure.Arrival.time.convenient across Gender", colour = "Gender")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5)) 
service2_g
# Ease.of.Online.booking across Gender
service3_g <- ggplot(airline_df, aes(Ease.of.Online.booking, colour = Gender, fill = Gender)) + geom_bar(position = "dodge") + scale_fill_manual(values=c("#9933FF","#33FFFF"))+ 
  labs(title = "Ease.of.Online.booking across Type of Travel", colour = "Gender")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5)) 
service3_g
# Gate.location across Gender
service4_g <- ggplot(airline_df, aes(Gate.location, colour = Gender, fill = Gender)) + geom_bar(position = "dodge") + scale_fill_manual(values=c("#9933FF","#33FFFF"))+ 
  labs(title = "Gate.location across Gender", colour = "Gender")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5)) 
service4_g
# Food.and.Drink across Gender
service0_g <- ggplot(airline_df, aes(Food.and.drink, colour = Gender, fill = Gender)) + geom_bar(position = "dodge") + scale_fill_manual(values=c("#9933FF","#33FFFF"))+ 
  labs(title = "Gate.location across Gender", colour = "Gender")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5)) 
service0_g
# Online.boarding across Gender
#In comparison, female customers are more satisfied in the online boarding service than male customers as most of the ratings are above 3 ratings.
service5_g <- ggplot(airline_df, aes(Online.boarding, colour = Gender, fill = Gender)) + geom_bar(position = "dodge") + scale_fill_manual(values=c("#9933FF","#33FFFF"))+ 
  labs(title = "Online.boarding across Gender", colour = "Gender")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5)) 
service5_g
# Seat.comfort across Gender
#In comparison, female customers are more satisfied in the seat comfort aspect than male customers as most of the ratings are above 3 ratings.
service6_g <- ggplot(airline_df, aes(Seat.comfort, colour = Gender, fill = Gender)) + geom_bar(position = "dodge") + scale_fill_manual(values=c("#9933FF","#33FFFF"))+ 
  labs(title = "Seat.comfort across Gender", colour = "Gender")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5)) 
service6_g
# Inflight.entertainment across Gender
service7_g <- ggplot(airline_df, aes(Inflight.entertainment, colour = Gender, fill = Gender)) + geom_bar(position = "dodge") + scale_fill_manual(values=c("#9933FF","#33FFFF"))+
  labs(title = "Inflight.entertainment across Gender", colour = "Gender")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5)) 
service7_g
# On.board.service across Gender
service8_g <- ggplot(airline_df, aes(On.board.service, colour = Gender, fill = Gender)) + geom_bar(position = "dodge") + scale_fill_manual(values=c("#9933FF","#33FFFF"))+ 
  labs(title = "On.board.service across Gender", colour = "Gender")+
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5)) 
service8_g
# Leg.room.service across Gender
#Female passengers are more dissatisfied with the lower rating given to leg room service, as compared to male passengers.
service9_g <- ggplot(airline_df, aes(Leg.room.service, colour = Gender, fill = Gender)) + geom_bar(position = "dodge") + scale_fill_manual(values=c("#9933FF","#33FFFF"))+
  labs(title = "Leg.room.service across Gender", colour = "Gender")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5)) 
service9_g
# Baggage.handling across Gender
#Female passengers are more dissatisfied in baggage handling service than male passengers. Possible reason is that female passengers carry cosmetic products that are fragile items and thus negligence in handling with care cause them to be unhappy with the service.
service10_g <- ggplot(airline_df, aes(Baggage.handling, colour = Gender, fill = Gender)) + geom_bar(position = "dodge") + scale_fill_manual(values=c("#9933FF","#33FFFF"))+ 
  labs(title = "Baggage.handling across Gender", colour = "Gender")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5)) 
service10_g
# Checkin.service across Gender
service11_g <- ggplot(airline_df, aes(Checkin.service, colour = Gender, fill = Gender)) + geom_bar(position = "dodge") + scale_fill_manual(values=c("#9933FF","#33FFFF"))+ 
  labs(title = "Checkin.service across Gender", colour = "Gender")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5)) 
service11_g
# Inflight.service across Gender
#Female passengers are more dissatisfied in inflight service than male passengers.
service12_g <- ggplot(airline_df, aes(Inflight.service, colour = Gender, fill = Gender)) + geom_bar(position = "dodge") + scale_fill_manual(values=c("#9933FF","#33FFFF"))+ 
  labs(title = "Inflight.service across Gender", colour = "Gender")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5)) 
service12_g
# Cleanliness across Gender
service13_g <- ggplot(airline_df, aes(Cleanliness, colour = Gender, fill = Gender)) + geom_bar(position = "dodge") + scale_fill_manual(values=c("#9933FF","#33FFFF"))+ 
  labs(title = "Cleanliness across Gender", colour = "Gender")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5)) 
service13_g
# Departure.Delay.in.Minutes across Gender
service14_g <-
  ggplot(airline_df, 
         aes(x = Gender,
             y = Departure.Delay.in.Minutes,
             fill = Gender,
             color = Gender)) + 
  geom_violin(width = 0.3, position = position_dodge())+
  geom_boxplot(width = 0.1, color = "black", alpha = 0.2) +
  labs(title = "Departure.Delay.in.Minutes by Gender", 
       x = "Gender",
       y = "Departure.Delay.in.Minutes") + 
  scale_fill_brewer(palette="Spectral")
service14_g


```

### Customer Type

```{r include = FALSE, warning = FALSE}
# customer type
cs_type_df <- airline_df %>%
  group_by(Customer.Type) %>%
  summarise(counts = n()) %>% 
  mutate(perc = counts / sum(counts)) %>% 
  arrange(perc) %>%
  mutate(labels = scales::percent(perc))

# customer type by type of travel and class
cs_type_travel_class_df <- airline_df %>%
  group_by(Customer.Type, Type.of.Travel, Class) %>%
  summarise(counts = n())

# customer type by satisfaction
cs_type_satisfaction_df <- airline_df %>%
  group_by(Customer.Type, satisfaction) %>%
  summarise(counts = n())

# customer type by satisfaction and satisfaction level in each factors
cs_type_satisfaction_lvl_df <- airline_df[c(3,8:21,24)]
cs_type_satisfaction_lvl_df <- 
  cs_type_satisfaction_lvl_df %>% 
  pivot_longer(-c(Customer.Type, satisfaction),
               names_to = "factors",
               values_to = "satisfaction.level")  %>%
  group_by(Customer.Type, satisfaction, factors, satisfaction.level) %>%
  summarise(counts = n())
```

```{r echo = FALSE, warning = FALSE}
# customer type
cs_type_g <- 
  ggplot(cs_type_df, 
         aes(x = "",
             y = perc, 
             fill = Customer.Type)) + 
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start = 0) +
  guides(fill=guide_legend(title="Customer Type")) +
  geom_text(aes(label = labels), 
            position = position_stack(vjust = 0.5),
            show.legend = FALSE) +
  scale_fill_brewer(palette="Spectral") +
  labs(title = "Customer Type") +
  theme_void()
cs_type_g

# customer type by type of travel and class
cs_type_travel_class_g <- 
  ggplot(cs_type_travel_class_df, 
         aes(x = Type.of.Travel,
             y = counts, 
             fill = Class)) + 
  geom_bar(stat='identity', position = "dodge") +
  labs(title = "Customer Type by Type of Travel and Class",
       x = "Type of Travel",
       y = "Frequency") + 
  facet_wrap(~Customer.Type) +
  scale_fill_brewer(palette="Spectral")
cs_type_travel_class_g

# customer type by gender and age
cs_type_gender_age_g <-
  ggplot(airline_df, 
         aes(x = Gender,
             y = Age,
             fill = Gender,
             color = Gender)) + 
  geom_violin(width = 0.3, position = position_dodge())+
  geom_boxplot(width = 0.1, color = "black", alpha = 0.2) +
  labs(title = "Customer Type by Gender and Age", 
       x = "Gender",
       y = "Age") + 
  facet_wrap(~Customer.Type) +
  scale_fill_brewer(palette="Spectral")
cs_type_gender_age_g

# Flight distance by customer type and class
cs_type_flight_d_g <- 
  ggplot(airline_df, 
         aes(x = Flight.Distance,
             fill = Customer.Type)) +
  geom_density(alpha = 0.3) +
  labs(title = "Flight Distance by Customer Type and Class",
       y = "Flight Distance", 
       x = "Customer Type") + 
  guides(fill=guide_legend(title="Customer Type")) +
  facet_grid(Class ~ .) + 
  scale_fill_brewer(palette = "Spectral")
cs_type_flight_d_g

# Customer Type by satisfaction
cs_type_satisfaction_g <- 
  ggplot(cs_type_satisfaction_df, 
         aes(x = satisfaction,
             y = counts, 
             fill = satisfaction)) + 
  geom_bar(stat='identity', position = "dodge", width = 0.5) +
  guides(fill=guide_legend(title="Satisfaction")) +
  labs(title = "Satisfaction by Customer Type",
       x = "Satisfaction",
       y = "Frequency") + 
  facet_wrap(~Customer.Type) +
  scale_fill_brewer(palette="Spectral")
cs_type_satisfaction_g
```

```{r echo = FALSE, warning = FALSE, fig.height = 20, fig.width = 12}
# Customer type by satisfaction and satisfaction level in each factors
cs_type_satisfaction_lvl_g <- 
  ggplot(cs_type_satisfaction_lvl_df, 
         aes(x = satisfaction.level,
             y = counts, 
             fill = satisfaction)) + 
  geom_bar(stat='identity', position = "dodge") +
  labs(title = "Customer Type by satisfaction and satisfaction level in each factors",
       x = "Satisfaction Level",
       y = "") + 
  facet_grid(factors~Customer.Type) +
  scale_fill_brewer(palette="Spectral")
cs_type_satisfaction_lvl_g
```

### Type of Travel

```{r echo = FALSE, warning = FALSE}
#### **From the perspective of feature "Type of Travel"**

**Below will focus on the perspective from feature "Type of Travel".**

```{r echo = FALSE, warning = FALSE}
library(ggplot2)
library(ggpubr)
# Type of Travel of Airline Passengers
p_1 <- ggplot(airline_df, aes(Type.of.Travel, colour = Type.of.Travel, fill = Type.of.Travel)) + geom_bar(position = "dodge") + 
  labs(title = "Type of Travel", colour = "Type.of.Travel", y = "Number of Airline Passengers", x = "Type of Travel")+
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 7)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))+
  theme(legend.key.height= unit(0.5, 'cm'),
        legend.key.width= unit(0.5, 'cm'))

p_2 <- ggplot(airline_df, aes(Type.of.Travel, colour = satisfaction, fill = satisfaction)) + geom_bar(position = "dodge") + 
  labs(title = "Satisfaction across Type of Travel", colour = "satisfaction", y = "Number of Airline Passengers", x = "Type of Travel")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 7)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))+
  theme(legend.key.height= unit(0.5, 'cm'),
        legend.key.width= unit(0.5, 'cm')) 

# Gender across Type of Travel
p_3 <- ggplot(airline_df, aes(Type.of.Travel, colour = Gender, fill = Gender)) + geom_bar(position = "dodge") + 
  labs(title = "Gender across Type of Travel", colour = "Gender", y = "Number of Airline Passengers", x = "Type of Travel")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 7)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))+
  theme(legend.key.height= unit(0.5, 'cm'),
        legend.key.width= unit(0.5, 'cm')) 

# Customer.Type across Type of Travel
p_4 <- ggplot(airline_df, aes(Type.of.Travel, colour = Customer.Type, fill = Customer.Type)) + geom_bar(position = "dodge") + 
  labs(title = "Customer Type across Type of Travel", colour = "Customer.Type", y = "Number of Airline Passengers", x = "Type of Travel")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 7)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))+
  theme(legend.key.height= unit(0.5, 'cm'),
        legend.key.width= unit(0.5, 'cm'))
  
# Age across Type of Travel
p_5 <- ggplot(airline_df, aes(Age, colour = Type.of.Travel, fill = Type.of.Travel)) + geom_density(alpha = 0.5) + 
  labs(title = "Age across Type of Travel", colour = "Type.of.Travel", y = "Number of Airline Passengers", x = "Type of Travel")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 7)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))+
  theme(legend.key.height= unit(0.5, 'cm'),
        legend.key.width= unit(0.5, 'cm')) 

# Flight Distance across Type of Travel
p_6 <- ggplot(airline_df,aes(x = Flight.Distance,fill = Type.of.Travel)) +
  geom_density(alpha = 0.5) +
  labs(title = "Flight Distance by Type of Travel",
       y = "Frequency", 
       x = "Flight Distance") + 
  guides(fill=guide_legend(title="Type.of.Travel")) + 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 7)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))+
  theme(legend.key.height= unit(0.5, 'cm'),
        legend.key.width= unit(0.5, 'cm')) 

ggarrange(p_1, p_2, p_3, p_4, nrow = 2, ncol=2)  
```
</p>
<li>As a first point, most passengers are traveling for business rather than for pleasure.</li>
<li>Satisfied level to the Airline services from passengers who took Business Travel are higher than passengers from Personal Travel. While the Neutral or dissatisfied level are about the same among both travel types. </li>
<li>Taking a look at the gender, both travel types have almost the same distribution, but Female passengers are slightly more than Male passengers. </li>
<li> Additionally, both types of travel have a greater percentage of loyal customers than disloyal customers.</li>

</p>
</p>
```{r echo = FALSE, warning = FALSE}
ggarrange(p_5, p_6, nrow = 2, ncol=1) 

```
</p>
<li> The majority of passengers who travel for business are at mid of 20 and 40 years old. In contrast, personal travel occurs equally from the age of 10 to the age of 60 approximately.</li>
<li> The flight distance of passengers who have taken Business Travel is obviously longer than passengers who have taken Personal Travel.</li>

</p>
---

#### **Satisfaction on the Airline Services from the perspective of "Type of Travel"**

**Below will focus on the 12 services given by Airlines:**

```{r echo = FALSE, warning = FALSE}

# Services
# Inflight.wifi.service across Type of Travel

p_7 <- ggplot(airline_df, aes(Inflight.wifi.service, colour = Type.of.Travel, fill = Type.of.Travel)) + geom_bar(position = "dodge") + 
  labs(title = "Inflight wifi service across Type of Travel", colour = "Type.of.Travel", y = "Number of Airline Passengers", x = "Rating")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 7)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))+
  theme(legend.key.height= unit(0.5, 'cm'),
        legend.key.width= unit(0.5, 'cm')) 

# Departure.Arrival.time.convenient across Type of Travel

p_8 <- ggplot(airline_df, aes(Departure.Arrival.time.convenient, colour = Type.of.Travel, fill = Type.of.Travel)) + geom_bar(position = "dodge") + 
  labs(title = "Departure Arrival time convenient across Type of Travel", colour = "Type.of.Travel", y = "Number of Airline Passengers", x = "Rating")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 7)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))+
  theme(legend.key.height= unit(0.5, 'cm'),
        legend.key.width= unit(0.5, 'cm')) 

# Ease.of.Online.booking across Type of Travel
p_9 <- ggplot(airline_df, aes(Ease.of.Online.booking, colour = Type.of.Travel, fill = Type.of.Travel)) + geom_bar(position = "dodge") + 
  labs(title = "Ease of Online booking across Type of Travel", colour = "Type.of.Travel", y = "Number of Airline Passengers", x = "Rating")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 7)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))+
  theme(legend.key.height= unit(0.5, 'cm'),
        legend.key.width= unit(0.5, 'cm')) 

# Gate.location across Type of Travel
p_10 <- ggplot(airline_df, aes(Gate.location, colour = Type.of.Travel, fill = Type.of.Travel)) + geom_bar(position = "dodge") + 
  labs(title = "Gate location across Type of Travel", colour = "Type.of.Travel", y = "Number of Airline Passengers", x = "Rating")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 7)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))+
  theme(legend.key.height= unit(0.5, 'cm'),
        legend.key.width= unit(0.5, 'cm')) 

# Online.boarding across Type of Travel
p_11 <- ggplot(airline_df, aes(Online.boarding, colour = Type.of.Travel, fill = Type.of.Travel)) + geom_bar(position = "dodge") + 
  labs(title = "Online boarding across Type of Travel", colour = "Type.of.Travel", y = "Number of Airline Passengers", x = "Rating")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 7)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))+
  theme(legend.key.height= unit(0.5, 'cm'),
        legend.key.width= unit(0.5, 'cm')) 

# Seat.comfort across Type of Travel
p_12 <- ggplot(airline_df, aes(Seat.comfort, colour = Type.of.Travel, fill = Type.of.Travel)) + geom_bar(position = "dodge") + 
  labs(title = "Seat comfort across Type of Travel", colour = "Type.of.Travel", y = "Number of Airline Passengers", x = "Rating")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 7)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))+
  theme(legend.key.height= unit(0.5, 'cm'),
        legend.key.width= unit(0.5, 'cm')) 

# Inflight.entertainment across Type of Travel
p_13 <- ggplot(airline_df, aes(Inflight.entertainment, colour = Type.of.Travel, fill = Type.of.Travel)) + geom_bar(position = "dodge") + 
  labs(title = "Inflight entertainment across Type of Travel", colour = "Type.of.Travel", y = "Number of Airline Passengers", x = "Rating")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 7)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))+
  theme(legend.key.height= unit(0.5, 'cm'),
        legend.key.width= unit(0.5, 'cm')) 

# On.board.service across Type of Travel
p_14 <- ggplot(airline_df, aes(On.board.service, colour = Type.of.Travel, fill = Type.of.Travel)) + geom_bar(position = "dodge") + 
  labs(title = "On board service across Type of Travel", colour = "Type.of.Travel", y = "Number of Airline Passengers", x = "Rating")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 7)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))+
  theme(legend.key.height= unit(0.5, 'cm'),
        legend.key.width= unit(0.5, 'cm')) 

# Leg.room.service across Type of Travel
p_15 <- ggplot(airline_df, aes(Leg.room.service, colour = Type.of.Travel, fill = Type.of.Travel)) + geom_bar(position = "dodge") + 
  labs(title = "Leg room service across Type of Travel", colour = "Type.of.Travel", y = "Number of Airline Passengers", x = "Rating")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 7)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))+
  theme(legend.key.height= unit(0.5, 'cm'),
        legend.key.width= unit(0.5, 'cm')) 

# Baggage.handling across Type of Travel
p_16 <- ggplot(airline_df, aes(Baggage.handling, colour = Type.of.Travel, fill = Type.of.Travel)) + geom_bar(position = "dodge") + 
  labs(title = "Baggage handling across Type of Travel", colour = "Type.of.Travel", y = "Number of Airline Passengers", x = "Rating")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 7)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))+
  theme(legend.key.height= unit(0.5, 'cm'),
        legend.key.width= unit(0.5, 'cm')) 

# Checkin.service across Type of Travel
p_17 <- ggplot(airline_df, aes(Checkin.service, colour = Type.of.Travel, fill = Type.of.Travel)) + geom_bar(position = "dodge") + 
  labs(title = "Checking service across Type of Travel", colour = "Type.of.Travel", y = "Number of Airline Passengers", x = "Rating")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 7)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))+
  theme(legend.key.height= unit(0.5, 'cm'),
        legend.key.width= unit(0.5, 'cm')) 

# Inflight.service across Type of Travel
p_18 <- ggplot(airline_df, aes(Inflight.service, colour = Type.of.Travel, fill = Type.of.Travel)) + geom_bar(position = "dodge") + 
  labs(title = "Inflight service across Type of Travel", colour = "Type.of.Travel", y = "Number of Airline Passengers", x = "Rating")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 7)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))+
  theme(legend.key.height= unit(0.5, 'cm'),
        legend.key.width= unit(0.5, 'cm')) 

# Cleanliness across Type of Travel
p_19 <- ggplot(airline_df, aes(Cleanliness, colour = Type.of.Travel, fill = Type.of.Travel)) + geom_bar(position = "dodge") + 
  labs(title = "Cleanliness across Type of Travel", colour = "Type.of.Travel", y = "Number of Airline Passengers", x = "Rating")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 7)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))+
  theme(legend.key.height= unit(0.5, 'cm'),
        legend.key.width= unit(0.5, 'cm')) 
```

```{r echo = FALSE, warning = FALSE}
ggarrange(p_7, p_8, p_9, p_10, nrow = 2, ncol=2)
```
</p>
<li> In general, majority of passengers from both travel types rate "2" to "4" for above 4 services. </li>
<li> For Business Travel, the service on the arrangement of **Gate location**, overall, is better than the other 3 services as it has the lowest "0" rating, and  majority rate "3" to "4". Airline should focus more on the improvement for other 3 services for Business Travel passengers, especially **Departure Arrival Time Convenient**, as it contains highest "0" rating among other 3 services. </li>
<li> For Personal Travel, the **Departure Arrival Time Convenient's** service, in overall, is better than the other 3 services, which is contrast with Business Travel passengers' perspective.</li>
<li> To find the main reason of such contradiction, the airline is suggested to investigate the differences in **Departure Arrival Time Convenient's** services offered for both travel types. </li>
</p>
</p>
```{r echo = FALSE, warning = FALSE}
ggarrange(p_11, p_12, p_13, p_14, nrow = 2, ncol=2)

```
</p>
<li> According to the perspective of business travelers, "4" to "5" ratings are rated for above 4 services, which is in contradiction with the perspective of personal travelers, who majority rate "3" to "4". </li>
<li> Travelers of both types seemed to be satisfied with the **Seat comfort**, **In-flight entertainment**, and **On board service** provided by the airline, as there is lowest "0" ratings given.</li>
<li> However, the **Online boarding** need to be improved for both travel types, as there is "0" ratings and rating of "5" is the 2nd lowest among others. </li>
</p>
</p>

```{r echo = FALSE, warning = FALSE}
ggarrange(p_15, p_16, p_17, p_18, nrow = 2, ncol=2)
```
</p>
<li> It is astounding that both types of traveler give no "0" rating for service on **Baggage handling**. </li>
<li> Despite this, some attentions can still be given to **Leg room service*** and **Checking Service** for both types of travel, as the ratings of "1" and "2" are slightly higher than the other 2 services.</li>

</p>
</p>

Overall, </li>
</p>
For Business Travel, the first mentioned 4 services need higher attention than the other 8 services that mentioned latter, as the number of passengers rate for "2" to "4" is almost equally distributed, which indicates that the services is neither too bad nor too good.</li>
</p>
For Personal Travel, except the service **Departure Arrival time convenient** which shows significant high ratings, the other services still can take initiative to improve from ratings  "2" to "4" which stands majority, to ratings "3" to "5".</li>
</p>
```

### Class

```{r echo = FALSE, warning = FALSE}
# Class of Airline Passengers
class_1 <- ggplot(airline_df, aes(Class)) + geom_bar()+
  labs(title = "Class of Airline Passengers") + 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

 

# Satisfaction across Class
# q <- ggplot(df, aes(Class, colour = satisfaction, fill = satisfaction)) + geom_bar() +
# labs(title = "Satisfaction across Class", colour = "satisfaction")
# print(q)

 

class_2 <- ggplot(airline_df, aes(Class, colour = satisfaction, fill = satisfaction)) + geom_bar(position = "dodge") + 
  labs(title = "Satisfaction across Class", colour = "satisfaction")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

 

# Gender across Class
class_3 <- ggplot(airline_df, aes(Class, colour = Gender, fill = Gender)) + geom_bar(position = "dodge") + 
  labs(title = "Gender across Class", colour = "Gender")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

 

# Customer.Type across Class
class_4 <- ggplot(airline_df, aes(Class, colour = Customer.Type, fill = Customer.Type)) + geom_bar(position = "dodge") + 
  labs(title = "Customer.Type across Class", colour = "Customer.Type")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

 

# Customer.Type across Class
class_5 <- ggplot(airline_df, aes(Class, colour = Class, fill = Class)) + geom_bar(position = "dodge") + 
  labs(title = "Class across Class", colour = "Class")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

 

# Age across Class
class_6 <- ggplot(airline_df, aes(Age, colour = Class, fill = Class)) + geom_density(alpha = 0.5) + 
  labs(title = "Age across Class", colour = "Class")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

 

# Flight Distance across Class
class_7 <- ggplot(airline_df,aes(x = Flight.Distance,fill = Class)) +
  geom_density(alpha = 0.5) +
  labs(title = "Flight Distance by Class",
       y = "Frequency", 
       x = "Flight Distance") + 
  guides(fill=guide_legend(title="Class")) + 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

 

# Inflight.wifi.service across Class
class_8 <- ggplot(airline_df, aes(Inflight.wifi.service, colour = Class, fill = Class)) + geom_bar(position = "dodge") + 
  labs(title = "Inflight.wifi.service across Class", colour = "Class")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

 

# Departure.Arrival.time.convenient across Class
class_9 <- ggplot(airline_df, aes(Departure.Arrival.time.convenient, colour = Class, fill = Class)) + geom_bar(position = "dodge") + 
  labs(title = "Departure.Arrival.time.convenient across Class", colour = "Class")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

 

# Ease.of.Online.booking across Class
class_10 <- ggplot(airline_df, aes(Ease.of.Online.booking, colour = Class, fill = Class)) + geom_bar(position = "dodge") + 
  labs(title = "Ease.of.Online.booking across Class", colour = "Class")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

 

# Gate.location across Class
class_11 <- ggplot(airline_df, aes(Gate.location, colour = Class, fill = Class)) + geom_bar(position = "dodge") + 
  labs(title = "Gate.location across Class", colour = "Class")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

 

# Online.boarding across Class
class_12 <- ggplot(airline_df, aes(Online.boarding, colour = Class, fill = Class)) + geom_bar(position = "dodge") + 
  labs(title = "Online.boarding across Class", colour = "Class")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

 

# Seat.comfort across Class
class_13 <- ggplot(airline_df, aes(Seat.comfort, colour = Class, fill = Class)) + geom_bar(position = "dodge") + 
  labs(title = "Seat.comfort across Class", colour = "Class")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

 

# Inflight.entertainment across Class
class_14 <- ggplot(airline_df, aes(Inflight.entertainment, colour = Class, fill = Class)) + geom_bar(position = "dodge") + 
  labs(title = "Inflight.entertainment across Class", colour = "Class")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

 

# On.board.service across Class
class_15 <- ggplot(airline_df, aes(On.board.service, colour = Class, fill = Class)) + geom_bar(position = "dodge") + 
  labs(title = "On.board.service across Class", colour = "Class")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

 

# Leg.room.service across Class
class_16 <- ggplot(airline_df, aes(Leg.room.service, colour = Class, fill = Class)) + geom_bar(position = "dodge") + 
  labs(title = "Leg.room.service across Class", colour = "Class")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

 

# Baggage.handling across Class
class_17 <- ggplot(airline_df, aes(Baggage.handling, colour = Class, fill = Class)) + geom_bar(position = "dodge") + 
  labs(title = "Baggage.handling across Class", colour = "Class")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

 

# Checkin.service across Class
class_18 <- ggplot(airline_df, aes(Checkin.service, colour = Class, fill = Class)) + geom_bar(position = "dodge") + 
  labs(title = "Checkin.service across Class", colour = "Class")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

 

# Inflight.service across Class
class_19 <- ggplot(airline_df, aes(Inflight.service, colour = Class, fill = Class)) + geom_bar(position = "dodge") + 
  labs(title = "Inflight.service across Class", colour = "Class")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

 

# Cleanliness across Class
class_20 <- ggplot(airline_df, aes(Cleanliness, colour = Class, fill = Class)) + geom_bar(position = "dodge") + 
  labs(title = "Cleanliness across Class", colour = "Class")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

 

# Departure.Delay.in.Minutes across Class
class_21 <- ggplot(airline_df, aes(Departure.Delay.in.Minutes, colour = Class, fill = Class)) + geom_bar(position = "dodge") + 
  labs(title = "Departure.Delay.in.Minutes across Class", colour = "Class")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))

 

# Arrival.Delay.in.Minutes across Class
class_22 <- ggplot(airline_df, aes(Arrival.Delay.in.Minutes, colour = Class, fill = Class)) + geom_bar(position = "dodge") + 
  labs(title = "Arrival.Delay.in.Minutes across Class", colour = "Class")+ 
  theme(axis.text = element_text(size = 5)) + 
  theme(axis.title = element_text(size = 5)) +
  theme(plot.title = element_text(size = 5)) +
  theme(legend.text = element_text(size = 5))+
  theme(legend.title = element_text(size = 5))
```

# Results

# Conclusion
